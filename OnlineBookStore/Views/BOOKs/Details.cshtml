@model OnlineBookStore.Models.Entities.BOOK
@{
    Layout = "~/Views/Shared/_Layoutfront.cshtml";
}
@{
    ViewBag.Title = Model.BOOKNAME;
    var comments = (IEnumerable<OnlineBookStore.Models.Entities.COMMENT>)ViewBag.Comments;
    var ratingSum = ViewBag.RatingSum;
    var ratingCount = ViewBag.RatingCount;

    decimal rating = 0;
    if (ratingCount > 0)
    {
        rating = (ratingSum / ratingCount);
    }
    var totalRating = decimal.Parse(rating.ToString());
}
<style>
    button.btn.btn-fefault.cart {
        margin-left: 0;
        margin-bottom: 0;
    }

    .product-information {
        padding-top: 0;
        padding-left: 20px;
    }
</style>
<div class="product-details">
    <div class="col-md-5">
        <div class="view-product">
            @if (Model.PIC1 != null)
            {
            <img src="@Url.Content(Model.PIC1)" style="height:350px;width:350px" alt="1" />
            }
            @if (Model.PIC2 != null)
            {
            <img src="@Url.Content(Model.PIC2)" style="height:100px;width:100px" title="2" />
            }
            @if(Model.PIC3!=null)
            { 
            <img src="@Url.Content(Model.PIC3)" style="height:100px;width:100px" title="3" />
            }
            @if (Model.PIC4 != null)
            {

            <img src="@Url.Content(Model.PIC4)" style="height:100px;width:100px" title="4" />
            }
        </div>
    </div>
    <div class="col-md-7">
        <div class="product-information">
            <h2>@Model.BOOKNAME</h2>
            <p><b>Tác giả : </b>@Html.DisplayFor(model => model.AUTHOR.AUTHORNAME)</p>
            <p><b>Thể loại:</b> @Html.DisplayFor(model => model.BOOKTYPE.TYPENAME)</p>
            <p><b>Nhà xuất bản :</b>@Html.DisplayFor(model => model.PUBLISH.PUBLISHNAME)</p>
            <div>
                 @for (var i = 1; i <= totalRating; i++)
                       {<span class="starGlowN"></span>}
                 @for (var i = (totalRating + 1); i <= 5; i++)
                      {<span class="starFadeN"></span>}<h2 style="bottom:38px;left:160px;position:relative;">(@ratingCount đánh giá)</h2>
            </div>
            <span>
                <span style="bottom: 50px;position: relative;">@Html.DisplayFor(model => model.PRICE)đ</span>
                @if (Model.AMOUNT != 0)
                {
                    <label style="right: 140px;position: relative;">Hiện có : @Model.AMOUNT</label>
                    <a href="/ShoppingCart/AddtoCart1/@Model.BOOKID" class="btn btn-fefault cart" style="position: relative;right: 230px;top: 40px;">
                        <i class="fa fa-shopping-cart"></i>
                        Thêm vào giỏ hàng
                    </a>
                    <a href="/ShoppingCart/AddtoCart/@Model.BOOKID" class="btn btn-fefault cart" style="position: relative;left: 50px;top: 7px;">
                        <i class="fa fa-shopping-cart"></i>
                        Mua ngay
                    </a>
                }
                else
                {
                    <label style="right: 120px;position: relative;">Hết Hàng</label>
                }
            </span>
        </div>
    </div>
</div>
<h2 class="title text-center">Mô tả</h2>
<div class="col-md-12">
    <p style="position: relative;bottom: 20px;text-align:justify;">@Html.DisplayFor(model => model.DESCRIPTIONS)</p>
</div>

<h2 class="title text-center">Phản hồi</h2>
@foreach (var c in comments)
{
    <div class="row">
        <div class="col-md-2">
            <img src="~/Image/home/user-default.png" style="width:100%;height:100px" />
        </div>
        <div class="col-md-3">
            <i>@c.USER.ACCOUNT</i>
            <i>@c.COMMENTDATE</i>
            <br />
            @for (var i = 1; i <= c.RATING; i++)
            {
                <span class="starGlowN"></span>
            }
            @for (var i = (c.RATING + 1); i <= 5; i++)
            {
                <span class="starFadeN"></span>
            }
        </div>
        <div class="col-md-9">
            @Html.Raw(c.COMMENT1.Replace("\n", "<br />"))
        </div>
        @if(c.USERID.Equals(Session["Userid"]))
        {
            <a href="/Comments/Delete/@c.COMMENTID" onclick="return confirm('Bạn chắc chắn muốn xóa ?')">
                <span class="glyphicon glyphicon-trash"></span>
            </a>
        }
    </div>
    <br />
    <br />
}
@Html.Partial("_CommentBox")
<script>
    function SCRate() {
        for (var i = 1; i <= @totalRating; i++) {
            $("#sRate" + i).attr('class', 'starGlowN');
        }
    }
    $(function(){
        SCRate();
    });
</script>
